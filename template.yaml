#################################################################
## Templates
#################################################################

      ##########################################################
      ## Electricity Rate
      ##########################################################

  - sensor:
    - unique_id: current_electricity_rate
      name: Current Electricity Rate
      unit_of_measurement: "USD/kWh"
      device_class: monetary
      state: >
        {% if is_state('select.monthly_electric', 'Summer Rate') %}
          {{ 0.1296 }}
        {% elif is_state('select.monthly_electric', 'Winter Rate First 750') %}
          {{ 0.0REDACTED1 }}
        {% elif is_state('select.monthly_electric', 'Winter Rate Over 750') %}
          {{ 0.0591 }}
        {% endif %}

#################################################################
## Hot Tub
#################################################################

      ##########################################################
      ## Hot Tub Modes
      ##########################################################

  - sensor:
    - unique_id: hot_tub_mode
      name: Hot Tub Mode
      state: >
        {% if states('sensor.hot_tub_watts') | float > 10300 %}
          'CircPump-Blower-Pump1-Pump2-Heat'
        {% elif states('sensor.hot_tub_watts') | float > 9700 %}
          'CircPump-Pump1-Pump2-Heat'
        {% elif states('sensor.hot_tub_watts') | float > 8110 %}
          'CircPump-Blower-Pump1-Heat'
        {% elif states('sensor.hot_tub_watts') | float > 7990 %}
          'CircPump-Blower-Pump2-Heat'
        {% elif states('sensor.hot_tub_watts') | float > 7600 %}
          'CircPump-Pump1-Heat'
        {% elif states('sensor.hot_tub_watts') | float > 7500 %}
          'CircPump-Pump2-Heat'
        {% elif states('sensor.hot_tub_watts') | float > 5650 %}
          'CircPump-Blower-Heat'
        {% elif states('sensor.hot_tub_watts') | float > 5300 %}
          'CircPump-Heat'
        {% elif states('sensor.hot_tub_watts') | float > 5170 %}
          'CircPump-Blower-Pump1-Pump2'
        {% elif states('sensor.hot_tub_watts') | float > 4750 %}
          'CircPump-Pump1-Pump2'
        {% elif states('sensor.hot_tub_watts') | float > 2930 %}
          'CircPump-Blower-Pump1'
        {% elif states('sensor.hot_tub_watts') | float > 2630 %}
          'CircPump-Blower-Pump2'
        {% elif states('sensor.hot_tub_watts') | float > 2500 %}
          'CircPump-Pump1'
        {% elif states('sensor.hot_tub_watts') | float > 2380 %}
          'CircPump-Pump2'
        {% elif states('sensor.hot_tub_watts') | float > 500 %}
          'CircPump-Blower'
        {% elif states('sensor.hot_tub_watts') | float > 150 %}
          'CircPump'
        {% else %}
          Off
        {% endif %}

    ##########################################################
    ## Circulation Pump
    ##########################################################

  - binary_sensor:
    - unique_id: hot_tub_circ_pump
      name: Hot Tub Circ Pump
      state: >
        {% if is_state('sensor.hot_tub_mode', 'Off') %}
          off
        {% else %}
          on
        {% endif %}

      ##########################################################
      ## Pump 1
      ##########################################################

  - binary_sensor:
    - unique_id: hot_tub_pump_1
      name: Hot Tub Pump 1
      state: >
        {{ is_state('sensor.hot_tub_mode', 'CircPump-Blower-Pump1-Pump2-Heat')
          or is_state('sensor.hot_tub_mode', 'CircPump-Pump1-Pump2-Heat')
          or is_state('sensor.hot_tub_mode', 'CircPump-Blower-Pump1-Heat')
          or is_state('sensor.hot_tub_mode', 'CircPump-Pump1-Heat')
          or is_state('sensor.hot_tub_mode', 'CircPump-Blower-Pump1-Pump2')
          or is_state('sensor.hot_tub_mode', 'CircPump-Pump1-Pump2')
          or is_state('bsensor.hot_tub_mode', 'CircPump-Blower-Pump1') 
          or is_state('sensor.hot_tub_mode', 'CircPump-Pump1') }}
        
      ##########################################################
      ## Pump 2
      ##########################################################

  - binary_sensor:
    - unique_id: hot_tub_pump_2
      name: Hot Tub Pump 2
      state: >
        {{ is_state('sensor.hot_tub_mode', 'CircPump-Blower-Pump1-Pump2-Heat')
           or is_state('sensor.hot_tub_mode', 'CircPump-Pump1-Pump2-Heat')
           or is_state('sensor.hot_tub_mode', 'CircPump-Blower-Pump2-Heat')
           or is_state('sensor.hot_tub_mode', 'CircPump-Pump2-Heat')
           or is_state('sensor.hot_tub_mode', 'CircPump-Blower-Pump1-Pump2')
           or is_state('sensor.hot_tub_mode', 'CircPump-Pump1-Pump2')
           or is_state('sensor.hot_tub_mode', 'CircPump-Blower-Pump2') 
           or is_state('sensor.hot_tub_mode', 'CircPump-Pump2') }}


      ##########################################################
      ## Air Blower
      ##########################################################

  - binary_sensor:
    - unique_id: hot_tub_air_blower
      name: Hot Tub Air Blower
      state: >
        {{ is_state('sensor.hot_tub_mode', 'CircPump-Blower-Pump1-Pump2-Heat')
           or is_state('sensor.hot_tub_mode', 'CircPump-Blower-Pump1-Heat')
           or is_state('sensor.hot_tub_mode', 'CircPump-Blower-Pump2-Heat')
           or is_state('sensor.hot_tub_mode', 'CircPump-Blower-Heat')
           or is_state('sensor.hot_tub_mode', 'CircPump-Blower-Pump1-Pump2')
           or is_state('sensor.hot_tub_mode', 'CircPump-Blower-Pump1')
           or is_state('sensor.hot_tub_mode', 'CircPump-Blower-Pump2') 
           or is_state('sensor.hot_tub_mode', 'CircPump-Blower') }}

      ##########################################################
      ## Heater
      ##########################################################

  - binary_sensor:
    - unique_id: hot_tub_heater
      name: Hot Tub Heater
      state: >
        {{ is_state('sensor.hot_tub_mode', 'CircPump-Blower-Pump1-Pump2-Heat')
           or is_state('sensor.hot_tub_mode', 'CircPump-Pump1-Pump2-Heat')
           or is_state('sensor.hot_tub_mode', 'CircPump-Blower-Pump1-Heat')
           or is_state('sensor.hot_tub_mode', 'CircPump-Blower-Pump2-Heat')
           or is_state('sensor.hot_tub_mode', 'CircPump-Pump1-Heat')
           or is_state('sensor.hot_tub_mode', 'CircPump-Pump2-Heat')
           or is_state('sensor.hot_tub_mode', 'CircPump-Blower-Heat')
           or is_state('sensor.hot_tub_mode', 'CircPump-Heat') }}